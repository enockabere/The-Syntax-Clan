{% extends 'base.html' %}
{% load static %}
{% block base %}
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="{% static 'plugins/Moment/moment.js' %}"></script>
<link rel="stylesheet"
    href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
<section class="section">
    <div class="section-header">
        <h1>Veterinary Medicine Advertisement Application Form</h1>
        <div class="section-header-breadcrumb">
            <div class="breadcrumb-item active"><a href="{% url 'dashboard' %}">Dashboard</a></div>
            <div class="breadcrumb-item"><a href="#">New Application</a></div>
            <div class="breadcrumb-item">New Applications</div>
        </div>
    </div>
    <div class="row bg-white">
        <div class="col-md-12">
            {% include 'alert.html' %}
            <form id="regForm" class="bg-white p-4" method="post">
                {% csrf_token %}
                <input type="hidden" name="advertisementNo" id="advertisementNo" value="">
                <input type="hidden" name="myAction" id="myAction" value="insert">
                <div class="border border-success rounded p-3  my-3">
                    <p class="text-small text-primary">Advertisement Information</p>
                    <div class="row my-3">
                        <div class="col-md-12">
                            <label class="form-label">Form Of Advertisement <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" name="formOfAdvertisement" id="formOfAdvertisement">
                            <div id="formOfAdvertisementerror" style="color: red; display: none;">required field
                            </div>
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary my-3 w-100">Save Application</button>
            </form>

        </div>
    </div>
</section>

<script>
    const $headerForm = $('#regForm');
    $(document).ready(function () {
        $headerForm.on('submit', (e) => {
            e.preventDefault();
            let formOfAdvertisement = document.getElementById("formOfAdvertisement")
            let formOfAdvertisementerror = document.getElementById("formOfAdvertisementerror")
            formOfAdvertisement.style.border = "1px solid #28a745"
            formOfAdvertisementerror.style.display = "none"

            if ($('#formOfAdvertisement').val() === '') {
                // alert('Please fill in all required fields.');
                formOfAdvertisement.style.border = "1px solid red"
                formOfAdvertisementerror.style.display = "block"
                return false;
            }

            $.ajax({
                type: 'POST',
                url: '/selfservice/advertise/',
                data: {
                    advertisementNo: $("#advertisementNo").val(),
                    formOfAdvertisement: $('#formOfAdvertisement').val(),
                    proposedCategory: $('#proposedCategory').val(),
                    myAction: $("#myAction").val(),
                    csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
                },
                success: function (response) {
                    if (response['response']) {
                        window.location.href = "/selfservice/advertise/" + response[
                                'response'] +
                            "/";
                        iziToast.show({
                            theme: 'dark',
                            backgroundColor: '#0974bd',
                            icon: 'las la-check-circle',
                            title: response['response'] +
                                " " +
                                "created successfully",
                            position: 'topRight',
                            progressBarColor: '#F4F6F7',
                        });
                        $('#formOfAdvertisement').val(
                            '');
                    } else if (response['error']) {
                        iziToast.show({
                            theme: 'dark',
                            icon: 'las la-exclamation',
                            title: 'Error',
                            message: response['error'],
                            position: 'topRight',
                            progressBarColor: '#ff0800',
                        });
                    }
                },
                error: function (error) {
                    console.log(error)
                }
            });
        });
    })
</script>
{% endblock %}